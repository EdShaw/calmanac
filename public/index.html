<!DOCTYPE html>
<html>
<head>
  <title>cAlmanac - Filter your timetables by course.</title>

  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/chosen/1.0/chosen.min.css">

</head>
<body>
  Select your courses, then select which calendar you want!<br />
  <form>
    <select class="chosen-select" id="course-select" data-placeholder="Choose courses..." name="courses[]" style="width:600px;" multiple="">
    </select>
  </form>
  <br />
  <a id="lectures" class="calendar-link" href="./lectures.ics">Lectures</a>
  <a id="practicals" class="calendar-link" href="./practicals.ics">Practicals</a>
  <a id="classes" class="calendar-link" href="./classes.ics">Classes</a>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js" type="text/javascript"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/chosen/1.0/chosen.jquery.js" type="text/javascript"></script>
  <script type="text/javascript">
    $( function() {
      $.ajax("./api/coursenames").done(function(data){
        data.foreach(function(name){
          $("#course-select").append($("<option></option>")
           .attr("value", name).text(name));
        })
      })
    });
    $("#course-select")
      .chosen({})
      .change(function() {
       var query = $(this).serialize();
       $("a[href].calendar-link").each(function () {
         $(this).attr("href", "./" + $(this).attr('id') + ".ics?" + query )
       });
     });

  </script>
</body>
</html>